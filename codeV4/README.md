Version 4  : D sorted as a whole, and w_1=Wx(1:128 , 1:ld) and W_2 = Wx(129:138, 1:ld) . I believe this to be correct.

at ld = 5 and D_power = 2; 
mAP = 0.2567
mAP_euclidian = 0.1168

bug : ld can be in 1 to 138 . Not limited upto 10
